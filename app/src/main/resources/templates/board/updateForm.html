<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
    <head>
      <title>여기모여</title>
      <!-- basic -->
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- mobile metas -->
      <!-- site metas -->
      <meta name="keywords" content="">
      <meta name="description" content="">
      <meta name="author" content="">
      <!-- bootstrap css -->
      <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
      <!-- style css -->
      <link rel="stylesheet" type="text/css" href="../css/style.css">
      <!-- Responsive-->
      <!-- fevicon -->
      <link rel="icon" href="../images/fevicon.png" type="image/gif" />
      <!-- Scrollbar Custom CSS -->
      <!-- Tweaks for older IEs-->
      <!-- owl stylesheets --> 
      <!-- 공식부트스트랩 CSS -->
      <link href="../css/bootstrap/bootstrap.css" rel="stylesheet">
      <!-- summernote 관련 소스 -->
      <link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
      <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
      <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
      <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>

<style>
.post_form1 {
  width: 800px;
  height: 40px;
  padding-left: 10px;
  margin-bottom: 20px;
  font-size: 15px;
  color: black;
  width:1100px;
  border: 1px solid #cccccc;
  border-radius: 5px;
}

.post_form2 {
  float: left;
  margin: 10px 0px;
}

.furnitures_sectionJD {
  width: 100%;
  min-height: 800px;
  float: left;
  padding-bottom: 90px;
  margin-left: 60px;
}

.post_button_box {
  width: 800px;
  margin-left: 77%;
}

.btn-outline-secondary {
  margin-top: 10px;
  color: #0d6efd;
  background-color: #ffffff00;
  border: 1px solid grey;
}
.btn-outline-secondary:hover {
  color: #ffffff;
  background-color: #0d6efd;
  transition: all .3s ease;
}
</style>
</head>
<body>
	<!-- header section start -->
	<div class="header_section">
		<div class="container-fluid">
			<nav class="navbar navbar-expand-lg navbar-light">
				<div class="main_logo"><a href="/app"><img src="../images/logo.png"></a></div>
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarSupportedContent">
					<ul class="navbar-nav mr-auto">
						<li class="nav-item"><a class="nav-link" href="../party/list">운동찾기</a></li>
						<li class="nav-item"><a class="nav-link" href="main">커뮤니티</a></li>
						<li class="nav-item"><a class="nav-link" href="../notice/list">공지사항</a></li>
					</ul>
					<div class="login-bt">
            <ul>
              <li data-th-if="${session.loginMember == null}"><a href="../auth/form" >로그인</a></li>
              <li data-th-if="${session.loginMember != null}"><a href="../auth/logout" data-th-text="${session.loginMember.name} + '(로그아웃)'">동동(로그아웃)</a></li>
            </ul>
					</div>
				</div>
			</nav>
		</div>
	</div>
	<!-- header section end -->
      <!-- furnitures section start -->
      <div class="furnitures_sectionJD layout_padding">
        <div class="row"  style="justify-content: center;">
           <!-- 게시글 수정폼 시작 -->
            <form class="post_max_box" action='update' method="post" enctype="multipart/form-data">
                <input id="boardNo" name='no' type="hidden" data-th-value="${board.no}">
                <input name='cateno' type="hidden" data-th-value="${board.cateno}">
                <table class="table_form" style="width:1100px">
                    <tr>
                      <td><input class="post_form1" name='title' type='text' value='제목' data-th-value='${board.title}' size='60'></td>
                    </tr>
                    <tr data-th-if="${board.cateno == 3}">
                      <td>
                          <div style="width: 300px">
                            <img id="previewImg" th:if="${board.thumbnail != null}"  th:src="@{'/board/files/' + ${board.thumbnail}}" alt="Avatar" class="image party_detail_img">
                            <img id="previewImg" th:if="${board.thumbnail == null}"  src="/app/board/files/nothumpnail.jpg" alt="Avatar" class="image">
                          </div>
                          <input class="post_form2"  id="fileTag" name='file' type="file">
                      </td>
                    </tr> 
                    <tr>
                      <td>
                        <textarea class="form-content" id="summernote" name='content' th:text="${board.content}"></textarea>
                      </td> 
                    </tr>
                </table>
                <div class="post_button_box">
                    <input class="btn btn-outline-secondary" id="subBtn" type="button" value="수정" onclick="goWrite(this.form);"/>
                    <input class="btn btn-outline-secondary none" id="subBtn" type="button" value="취소" onclick="updateCancel()"/>
                </div>
            </form>
	         </div>
           <!-- 게시글 수정폼 끝 -->
         </div>
     <!-- furnitures section end -->
      <!-- copyright section start -->
      <div class="copyright_section">
        <div class="container">
           <div class="social_icon">
              <ul>
                 <li><a href="#"><img src="../images/fb-icon.png"></a></li>
                 <li><a href="#"><img src="../images/twitter-icon.png"></a></li>
                 <li><a href="#"><img src="../images/instagram-icon.png"></a></li>
                 <li><a href="#"><img src="../images/linkedin-icon.png"></a></li>
              </ul>
           </div>
           <p class="copyright_text">2020 All Rights Reserved. Design by <a href="https://html.design">Free html  Templates</a></p>
        </div>
      </div>
      <!-- copyright section end -->

<!-- Javascript files-->
<!-- 썸머노트 자바스크립트 시작 -->
<script>
  function goWrite(frm) {
      var title = frm.title.value;
      var content = frm.content.value;
      if (title.trim() == '') {
        swal('','제목을 입력해주세요','warning');
            return false;
      }
      if (content.trim() == '') {
        swal('','내용을 입력해주세요','warning').then(() =>{
            return false;
        });
      } else {
          swal({
              text : "게시글을 수정하시겠습니까?",
              icon : "info",
              buttons : ["아니요", "예"],
            }).then(function(isConfirm) {
              if (isConfirm) {
                frm.submit();
              } else{
                return false;
              }
          });
      }
  
  }

  $(document).ready(function() {
    $('textarea[name=content]').summernote({maxWidth: 1000, height: 700});
  });

/*   function goWrite(frm) {
    var title = frm.title.value;
    var content = frm.content.value;
    if (title.trim() == '') {
      alert("제목을 입력해주세요");
      return false;
    }
    if (content.trim() == '') {
      alert("내용을 입력해주세요");
      return false;
    }
    frm.submit();
  } */
</script>

<script type="text/javascript">
const boardNo = document.getElementById( 'boardNo').value;
$('#fileTag').on('change', function () {
    if(window.FileReader){
       
    } else {
        var filename = $(this).val().split('/').pop().split('\\').pop();
    }
    $(this).prev().val(filename); //input upload-name 에 파일명 설정해주기

    readImage($(this)[0]); //미리보기
});

function validFileType(filename) {
    const fileTypes = ["png", "jpg", "jpeg"];
return fileTypes.indexOf(filename.substring(filename.lastIndexOf(".")+1, filename.length).toLowerCase()) >= 0;
}

function validFileSize(file){
    if(file.size > 5000000){ //5MB
        return false;
    }else{
        return true;
    }
}

//이미지 띄우기
function readImage(input) {
    if(input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e){
            const previewImage = document.getElementById("previewImg");
            previewImage.src = e.target.result;
        }
        // reader가 이미지 읽도록 하기
        reader.readAsDataURL(input.files[0]);
    }
}
function updateCancel() {
	  swal({
	        text : "게시글을 수정을 취소하시겠습니까?",
	        icon : "info",
	        buttons : ["아니요", "예"],
	      }).then(function(isConfirm) {
	        if (isConfirm) {
	          location.href= 'detail?no=' + boardNo;
	        } else{
	          return false;
	        }
	    });
	}
	
	

</script>

<!--    <script src="../js/jquery.min.js"></script> -->
<!-- <script src="../js/popper.min.js"></script> -->
<!-- <script src="../js/bootstrap.bundle.min.js"></script> -->
<script src="../js/jquery-3.0.0.min.js"></script>
<script src="../js/plugin.js"></script>
<!-- sidebar -->
<!-- <script src="../js/jquery.mCustomScrollbar.concat.min.js"></script> -->
<!-- <script src="../js/custom.js"></script>  -->
<!-- javascript --> 
<!-- <script src="../js/owl.carousel.js"></script> -->
<!-- <script src="https:cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>   -->
<!-- sweetalert -->
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<!-- 공식부트스트랩 JS -->
<!-- <script src="../js/bootstrap/bootstrap.js"></script> -->   
    </body>
</html>